<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Lecture de Vid√©o</title>
        <link rel="stylesheet" href="lecteurvideo.css">
        <link rel="icon" href="logo.png" type="image/png"> <!-- Ic√¥ne de l'onglet -->
        <script src="theme.js" defer></script>
        <script src="dropdown.js" defer></script>
    </head>
<body>
    <div class="navbar">
        <div class="logo">
            <a href="#top">
                <a href="index.php">
					<img src="logo.png" alt="Logo" class="logo-image"> <!-- Remplacement par l'image -->
				</a>
            </a>
        </div>
        <div class="settings">
            <img src="gear-icon.png" alt="Settings" class="settings-icon" id="settings-icon">
            <div class="dropdown-menu" id="dropdown-menu">
                <button id="theme-toggle">Changer de th√®me</button>
                <button id="trending-button">Tendance</button> <!-- Nouveau bouton -->
            </div>
        </div>
        <a href="update.html" class="upload-button">Upload</a>
    </div>

    <div id="video-container">
        <div id="video-wrapper">
            <video id="video-player" controls autoplay>
                Votre navigateur ne supporte pas la lecture de vid√©os.
            </video>
        </div>
        <div id="info-wrapper">
            <h1 id="video-title">Titre de la Vid√©o</h1>
            <p id="view-counter">Vues : 0</p>
            <div id="like-dislike-buttons">
                <button id="like-button" class="like-button">üëç <span id="like-count">0</span></button>
                <button id="dislike-button" class="dislike-button">üëé <span id="dislike-count">0</span></button>
            </div>
        </div>
    </div>

    <!-- Section pour les vid√©os al√©atoires -->
    <div id="random-videos">
        <h2>Recommandations</h2>
        <div class="random-gallery">
            <!-- Les vid√©os al√©atoires seront ins√©r√©es ici -->
        </div>
    </div>

    <script src="likes.js"></script>
    <script>
        // R√©cup√®re le param√®tre "video" dans l'URL
        const urlParams = new URLSearchParams(window.location.search);
        const videoName = urlParams.get("video");

        if (videoName) {
            // D√©finit la source de la vid√©o
            const videoPlayer = document.getElementById("video-player");
            videoPlayer.src = `video/${videoName}.mp4`;

            // D√©finit le titre de la vid√©o
            const videoTitle = document.getElementById("video-title");
            videoTitle.textContent = videoName;

            // Met √† jour le compteur de vues
            fetch(`views.php?video=${encodeURIComponent(videoName)}`)
                .then(response => response.text())
                .then(views => {
                    document.getElementById("view-counter").textContent = `Vues : ${views}`;
                })
                .catch(error => console.error("Erreur lors de la r√©cup√©ration des vues :", error));

            // Charge les likes et dislikes
            loadLikesDislikes(videoName);
        } else {
            document.body.innerHTML = "<p>Vid√©o introuvable.</p>";
        }

        // G√©n√®re 5 vid√©os al√©atoires
        const allVideos = [
            "30_secondes", "blablabla_blebleble", "black_lagoon", "bouh", "Erika",
            "galaxy", "GMDM", "goofy_ahh", "goofy_compilation", "heisenburger",
            "im_free", "kuru_kuru", "me_at_the_zoo", "nature", "penguin", "rick_roll", "shimi"
        ];

        const randomVideos = [];
        while (randomVideos.length < 5) {
            const randomIndex = Math.floor(Math.random() * allVideos.length);
            const randomVideo = allVideos[randomIndex];
            if (!randomVideos.includes(randomVideo) && randomVideo !== videoName) {
                randomVideos.push(randomVideo);
            }
        }

        const randomGallery = document.querySelector(".random-gallery");
        randomVideos.forEach(video => {
            const videoElement = document.createElement("div");
            videoElement.classList.add("random-video-item");
            videoElement.innerHTML = `
                <a href="video.html?video=${encodeURIComponent(video)}">
                    <img src="image/${video}.jpg" alt="${video}">
                    <p>${video}</p>
                </a>
            `;
            randomGallery.appendChild(videoElement);
        });
    </script>
</body>
</html>